<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>üÉè –î—É—Ä–∞–∫ –æ–π—ã–Ω—ã</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            background: radial-gradient(circle at center, #6b4f33 0%, #3d2b1f 100%);
            font-family: "Segoe UI", sans-serif;
            color: #f5deb3;
            overflow: hidden;
            margin: 0;
            padding: 0;
        }

        .game-filed {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: url("https://www.transparenttextures.com/patterns/wood-pattern.png");
            background-size: cover;
            border: 8px solid #4e3723;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7) inset;
        }

        .card-back, .card-front {
            position: absolute;
            width: 80px;
            height: 120px;
            border-radius: 10px;
            background-size: cover;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card-back:hover {
            transform: translateY(-8px);
        }

        .next_button {
            position: absolute;
            bottom: 30px;
            right: 40px;
            background: linear-gradient(180deg, #8b5e3b 0%, #5a3a1c 100%);
            color: #fff8dc;
            border: 2px solid #3b2413;
            border-radius: 12px;
            padding: 14px 26px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            transition: all 0.25s ease;
        }

        .next_button:hover {
            background: linear-gradient(180deg, #a26b40 0%, #6b4222 100%);
            transform: scale(1.05);
        }

        .winner-popup {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(78, 55, 35, 0.9);
            color: #fff8dc;
            padding: 20px 40px;
            border-radius: 14px;
            font-size: 24px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
        }
    </style>
</head>
<body>
<div id="canvas" class="game-filed"></div>

<button id="next_move" class="next_button">‚û°Ô∏è –ö–µ–ª–µ—Å—ñ –∂“Ø—Ä—ñ—Å</button>

<div id="winner" class="winner-popup" style="display:none;"></div>

<script>
    function Card(id) {
        this.id = id;
        this.status = 0;
        this.hide = function(){
            document.getElementById(this.id).style.backgroundImage = "url('img/0.png')";
        }
        this.show = function(){
            document.getElementById(this.id).style.backgroundImage = "url('img/" + id + ".png')";
        }
    }

    const FIRST_HAND_OFFSET_X = 100;
    const FIRST_HAND_OFFSET_Y = 320;
    const SECOND_HAND_OFFSET_X = 100;
    const SECOND_HAND_OFFSET_Y = 40;
    const CENTER_OFFSET_Y = 140;
    const CENTER_OFFSET_Y2 = 190;
    const TRASH_OFFSET_X = 650;
    const CARD_HAND_WIDTH = 85;

    var cards = [];
    var centerStack = [];
    var currentPlayer = 1;
    var mainKind = 0;

    function stackSetup() {
        var canvas = document.getElementById("canvas");
        for(var i = 1; i<5; i++) {
            for(var j=6;j<15;j++) {
                var id = i * 100 + j;
                var el = document.createElement('div');
                el.id = id;
                el.classList.add("card-back");
                canvas.appendChild(el);
                cards.push(new Card(id));
            }
        }
    }

    function shuffle(array) {
        let counter = array.length;
        while (counter > 0) {
            let index = Math.floor(Math.random() * counter);
            counter--;
            let temp = array[counter];
            array[counter] = array[index];
            array[index] = temp;
        }
        return array;
    }

    function getKind(id){ return (id - (id%100))/100; }

    function relayoutStack() {
        for (let i = 0; i < cards.length; i++) {
            if(cards[i].status === 0) {
                let el = document.getElementById(cards[i].id);
                el.style.top = (i * 2) + "px";
                el.style.left = (i * 2) + "px";
                el.style.zIndex = i+"";
                cards[i].hide();
            }
        }
        mainKind = getKind(cards[0].id);
        var mainEl = document.getElementById(cards[0].id);
        mainEl.style.top = (150) + "px";
        cards[0].show();
    }

    function refillHand(status) {
        var current = getSize(status);
        for(var i=current;i<6;i++) {
            var stackSize = getSize(0);
            if(stackSize>0) {
                cards[stackSize - 1].status = status;
            }
        }
    }

    function getSize(status) {
        return cards.filter(c => c.status === status).length;
    }

    function renderHands() {
        let playerCounter = 0;
        let compCounter = 0;
        for(let i=0;i<cards.length;i++){
            let el = document.getElementById(cards[i].id);
            if(cards[i].status===1) {
                playerCounter++;
                el.style.left = FIRST_HAND_OFFSET_X + playerCounter * CARD_HAND_WIDTH+"px";
                el.style.top = FIRST_HAND_OFFSET_Y+"px";
                el.style.backgroundImage = "url('img/" + cards[i].id + ".png')";
            } else if(cards[i].status===2) {
                compCounter++;
                el.style.left = SECOND_HAND_OFFSET_X + compCounter * CARD_HAND_WIDTH+"px";
                el.style.top = SECOND_HAND_OFFSET_Y+"px";
            }
        }
    }

    function changePlayer() {
        currentPlayer = currentPlayer === 1 ? 2 : 1;
    }

    function showWinner(winner) {
        const popup = document.getElementById("winner");
        popup.innerText = winner === 1 ? "üéâ –ñ–µ“£—ñ–º–ø–∞–∑ ‚Äî –û–π—ã–Ω—à—ã 1!" :
                          winner === 2 ? "ü§ñ –ö–æ–º–ø—å—é—Ç–µ—Ä –∂–µ“£–¥—ñ!" :
                                         "ü§ù –¢–µ“£ –æ–π—ã–Ω!";
        popup.style.display = "block";
    }

    document.getElementById("next_move").onclick = function() {
        alert("–ö–µ–ª–µ—Å—ñ –∂“Ø—Ä—ñ—Å —ñ—Å–∫–µ “õ–æ—Å—ã–ª–¥—ã!");
    };

    // Initial setup
    stackSetup();
    shuffle(cards);
    relayoutStack();
    refillHand(1);
    refillHand(2);
    renderHands();
</script>
</body>
</html>